{"version":3,"file":"ai-services-demo/view.js","mappings":"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","sources":["webpack://ai-services-demo/./src/ai-services-demo/view.js"],"sourcesContent":["/**\n * Use this file for JavaScript code that you want to run in the front-end\n * on posts/pages that contain this block.\n *\n * When this file is defined as the value of the `viewScript` property\n * in `block.json` it will be enqueued on the front end of the site.\n *\n * Example:\n *\n * ```js\n * {\n *   \"viewScript\": \"file:./view.js\"\n * }\n * ```\n *\n * If you're not making any changes to this file because your project doesn't need any\n * JavaScript running in the front-end, then you should delete this file and remove\n * the `viewScript` property from `block.json`.\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n */\n\n/* eslint-disable no-console */\nconsole.log('Hello World! (from jonathanbossenger-ai-services-demo block)');\n/* eslint-enable no-console' */\n\n/**\n * Frontend logic for AI Services Demo chat block.\n */\n\nconst initChat = (root) => {\n    const messagesEl = root.querySelector('.ai-chat__messages');\n    const form = root.querySelector('.ai-chat__form');\n    const input = root.querySelector('.ai-chat__input');\n    const loadingEl = root.querySelector('.ai-chat__loading');\n\n    if (!messagesEl || !form || !input) return;\n\n    // Move loading animation above textarea and button\n    if (loadingEl && form.parentNode !== null) {\n        form.parentNode.insertBefore(loadingEl, form);\n    }\n\n    const appendMsg = (role, text) => {\n        if (loadingEl) loadingEl.style.display = 'none';\n        const msg = document.createElement('div');\n        msg.className = `ai-chat__message ai-chat__message--${role}`;\n        msg.textContent = text;\n        messagesEl.appendChild(msg);\n        messagesEl.scrollTop = messagesEl.scrollHeight;\n    };\n\n    const setBusy = (busy) => {\n        form.querySelector('button[type=\"submit\"]').disabled = !!busy;\n        input.disabled = !!busy;\n        if (loadingEl) loadingEl.style.display = busy ? '' : 'none';\n    };\n\n    form.addEventListener('submit', async (e) => {\n        e.preventDefault();\n        const text = input.value.trim();\n        if (!text) return;\n        appendMsg('user', text);\n        input.value = '';\n        setBusy(true);\n        console.log('Nonce', window.aiServicesDemo?.nonce || 'empty nonce');\n        try {\n            const res = await fetch(window.aiServicesDemo?.restUrl || '/wp-json/ai-services-demo/v1/chat', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'X-WP-Nonce': window.aiServicesDemo?.nonce || ''\n                },\n                body: JSON.stringify({ message: text, instance: root.dataset.instance || '' })\n            });\n            if (!res.ok) throw new Error('Request failed');\n            const data = await res.json();\n            appendMsg('assistant', data?.reply || '');\n        } catch (err) {\n            console.error('Error fetching AI response:', err);\n            appendMsg('assistant', 'Sorry, something went wrong.');\n        } finally {\n            setBusy(false);\n        }\n    });\n};\n\nwindow.addEventListener('DOMContentLoaded', () => {\n    document.querySelectorAll('.wp-block-jonathanbossenger-ai-services-demo .ai-chat').forEach(initChat);\n});\n"],"names":["console","log","initChat","root","messagesEl","querySelector","form","input","loadingEl","parentNode","insertBefore","appendMsg","role","text","style","display","msg","document","createElement","className","textContent","appendChild","scrollTop","scrollHeight","setBusy","busy","disabled","addEventListener","e","preventDefault","value","trim","window","aiServicesDemo","nonce","res","fetch","restUrl","method","headers","body","JSON","stringify","message","instance","dataset","ok","Error","data","json","reply","err","error","querySelectorAll","forEach"],"sourceRoot":""}